workflows:
  ios-release:
    name: "SLM iOS"
    environment:
      flutter: stable
      xcode: latest
    scripts:
      - name: ğŸ§¹ Clean & Get packages
        script: |
          flutter clean
          flutter pub get

      - name: ğŸ“Œ Generate Podfile if missing
        script: |
          if [ ! -f ios/Podfile ]; then
            echo "âš™ï¸ No Podfile found. Running flutter build ios to generate..."
            flutter build ios --no-codesign
          fi

      - name: âœ… Increase iOS Deployment Target to 14.0
        script: |
          sed -i '' 's/platform :ios.*/platform :ios, '\''14.0'\''/' ios/Podfile

      - name: ğŸ“¦ Build iOS .ipa
        script: |
          flutter build ipa --export-options-plist=ios/ExportOptions.plist

    artifacts:
      - build/ios/**/*.ipa
